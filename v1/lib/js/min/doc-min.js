var cookie=document.cookie?JSON.parse('{"'+document.cookie.replace(/=/g, '":"').replace(/; /g, '","')+'"}'):{};var get=document.location.search?JSON.parse('{"'+document.location.search.substr(1).replace(/=/g, '":"').replace(/&/g, '","')+'"}'):{};if(get.code)auth.getTokenFromAuthCode(get.code);var auth={authority:"http://localhost",tokenUrl:"/aim/v1/api/oauth2/token",redirect_uri:document.location.href,clientId:"651F38C8-9264-44E7-991B-3D78A82C2A70",scope:'email name adres',getLoginUrl:function(){return this.authority+'/aim/v1/api/oauth2/authorize?response_type=code&client_id='+this.clientId+'&redirect_uri='+encodeURIComponent(this.redirect_uri)+'&prompt=login&scope='+this.scope.replace(/ /g, "+");},getTokenFromAuthCode:function(authCode){var formdata=new FormData();formdata.append('grant_type','authorization_code');formdata.append('code',authCode);formdata.append('redirect_uri',this.redirect_uri);formdata.append('client_id',this.clientId);var xhr=new XMLHttpRequest();xhr.open('post',this.authority+this.tokenUrl,true);xhr.send(formdata);xhr.onload=function(){console.log(this.responseText);}},}indexId=0;Aim.add(Doc={codeText:function(par){return [[par.method,[par.api,par.get?"?"+JSON.stringify(par.get).replace(/":"/g, "=").replace(/","/g, "&").replace(/{"|"}/g, ""):""].join(''),'HTTP/1.1'].join(' '),par.header?JSON.stringify(par.header).replace(/":/g, ": ").replace(/"|{|}/g, '').replace(/,/g, "\r\n"):"",JSON.stringify(par.put,null,2)].join("\r\n")},createIndex:function(){elementLevel=[elementIndex=document.getElementById('index')];elementIndex.innerText='';for(var i=0,e,c=document.getElementById('content').children;e=c[i];i++){if(['H1','H2','H3','H4'].indexOf(e.tagName)!=-1){var level=e.tagName[1],name=e.name||'index'+indexId++;with(elementLevel[level-1].appendTag('li')){var indexElement=appendTag('a',{innerText:e.innerText,href:'#'+name,attr:{open:0},onclick:Doc.selectIndexElement});elementLevel[level]=appendTag('ul');}e.insertBefore(e.appendTag('a',{name:name,indexElement:indexElement}),e.firstChild);}}window.scrollY=0;},createChapters:function(item){with(document.getElementById('content')){appendTag('h'+this.level,{innerText:item.title});if(item.summary)appendTag('div',{className:'intro',innerText:item.summary});if(item.BodyHTML)appendTag('div',{className:'body',innerHTML:item.BodyHTML.replace(/"\/shared/g, '"https:if(item.par){with(appendTag('div',{className:'panel'})){with(appendTag('div',{className:'tabControl'})){var navTabs=appendTag('nav',{className:'row'});with(appendTag('ul')){var tabOnclick=function(){for(var i=0,e,c=this.parentElement.children;e=c[i];i++){e.removeAttribute('selected');}this.setAttribute('selected','');console.log(this.pane);this.pane.parentElement.insertBefore(this.pane,this.pane.parentElement.firstChild);};with(navTabs.appendTag('span',{innerText:'AData 1.0',pane:appendTag('li'),onclick:tabOnclick,attr:{selected:1}}).pane){appendTag('pre').appendTag('code',{innerText:Doc.codeText({method:item.par.method,api:item.par.api,header:{'AData-Version':1.0},get:item.par.get,put:item.par.put})});appendTag('div',{className:'row buttonBar'}).appendTag('button',{innerText:'View the response',par:item.par,onclick:function(){this.par.header=this.par.header||{};delete this.par.header['OData-Version'];this.par.onload=response.onload;Aim.load(this.par);}});}with(navTabs.appendTag('span',{innerText:'OData 4.0',pane:appendTag('li'),onclick:tabOnclick}).pane){appendTag('pre').appendTag('code',{innerText:Doc.codeText({method:item.par.method,api:item.par.api,header:{'OData-Version':4.0},get:item.par.get,put:item.par.put})});appendTag('div',{className:'row buttonBar'}).appendTag('button',{innerText:'View the response',par:item.par,onclick:function(){this.par.header=this.par.header||{};this.par.header['OData-Version']=4.0;this.par.onload=response.onload;Aim.load(this.par);}});}with(navTabs.appendTag('span',{innerText:'JS',pane:appendTag('li'),onclick:tabOnclick}).pane){var params={header:{'OData-Version':4.0}};if(item.par.get)params.get=item.par.get;if(item.par.post)params.post=item.par.post;if(item.par.put)params.put=item.par.put;appendTag('pre').appendTag('code',{innerText:"Aim.load("+JSON.stringify(params,null,2).replace(/  "/g, "  ").replace(/":/g, ":")+");"});}with(navTabs.appendTag('span',{innerText:'PHP',pane:appendTag('li'),onclick:tabOnclick}).pane){var header=['"Authorization:Bearer ".$_SESSION["access_token"]','"Accept:application/json"','"OData-Version:4.0"'];if(item.par.post||item.par.put)header.push('"Content-Type:application/json"');var lines=['$url="https://aliconnect.nl/'+Aim.host+'/v1/api/'+(item.par.api||"")+'";','$curl=curl_init($url)','$headers=array(\r\n '+header.join(",\r\n  ")+'\r\n);','curl_setopt($curl,CURLOPT_HTTPHEADER,$headers);','curl_setopt($curl,CURLOPT_RETURNTRANSFER,true);','curl_setopt($curl,CURLOPT_SSL_VERIFYPEER,false);',];if(item.par.post)lines.push("$payload='"+JSON.stringify(item.par.post)+"'",'curl_setopt($curl,CURLOPT_POST,true);',"curl_setopt($curl,CURLOPT_POSTFIELDS,$payload);");if(item.par.put)lines.push("$payload='"+JSON.stringify(item.par.put)+"'",'curl_setopt($curl,CURLOPT_CUSTOMREQUEST,"PATCH");',"curl_setopt($curl,CURLOPT_POSTFIELDS,$payload);");lines.push('$response=curl_exec($curl);','curl_close($curl);');appendTag('pre').appendTag('code',{innerText:lines.join("\r\n")});}with(navTabs.appendTag('span',{innerText:'PHP SOAP',pane:appendTag('li'),onclick:tabOnclick}).pane){var options=['"http://localhost/aim/v1/api/soapserver"','"http://localhost/aim/v1/api/soapclient1asadfasd.php"','$_SESSION["client_id"]','$_SESSION["access_token"]'];var lines=['$options=array(\r\n '+options.join(",\r\n  ")+'\r\n);','$client=new SoapClient(null,$options);','$response=$client->getMessage(aaa);',];if(item.par.post)lines.push("$payload='"+JSON.stringify(item.par.post)+"'",'curl_setopt($curl,CURLOPT_POST,true);',"curl_setopt($curl,CURLOPT_POSTFIELDS,$payload);");if(item.par.put)lines.push("$payload='"+JSON.stringify(item.par.put)+"'",'curl_setopt($curl,CURLOPT_CUSTOMREQUEST,"PATCH");',"curl_setopt($curl,CURLOPT_POSTFIELDS,$payload);");lines.push('$response=curl_exec($curl);','curl_close($curl);');appendTag('pre').appendTag('code',{innerText:lines.join("\r\n")});}with(navTabs.appendTag('span',{innerText:'C++',pane:appendTag('li'),onclick:tabOnclick}).pane){appendTag('pre').appendTag('code',{innerText:['#include<iostream>','#include<string>','#include<curl/curl.h>','static size_t WriteCallback(void*contents,size_t size,size_t nmemb,void*userp)','{','((std::string*)userp)->append((char*)contents,size*nmemb);','return size*nmemb;','}','int main(void)','{','CURL*curl;','CURLcode res;','std::string readBuffer;','curl=curl_easy_init();','if(curl){','curl_easy_setopt(curl,CURLOPT_URL,"https://aliconnect.nl/aim/v1/api/'+(item.par.api||'')+'");','curl_easy_setopt(curl,CURLOPT_WRITEFUNCTION,WriteCallback);','curl_easy_setopt(curl,CURLOPT_WRITEDATA,&readBuffer);','res=curl_easy_perform(curl);','curl_easy_cleanup(curl);','std::cout<<readBuffer<<std::endl;','}','return 0;','}'].join("\r\n")});}with(navTabs.appendTag('span',{innerText:'Node.js',pane:appendTag('li'),onclick:tabOnclick}).pane){appendTag('pre').appendTag('code',{innerText:["var http=require('http');","var serviceRoot='https://aliconnect.nl/aim/v1/api/';","getURL(serviceRoot+'"+(item.par.schema)+"');","function getURL(url){","var body='';","http.get(url,function(response){","response.on('data',function(chunk){","body+=chunk;","});","response.on('end',function(){","console.log(body);","});","});","response.on('error',function(e){","console.log('ERROR:'+e.message);","});","}"].join("\r\n")});}}}}}}if(item.children)item.children.forEach(Doc.createChapters.bind({level:this.level+1}));},selectIndexElement:function(){for(var i=0,e,c=elementIndex.getElementsByTagName('A');e=c[i];i++){e.setAttribute('open',0);e.removeAttribute('selected');}for(var i=0,e=this;e !=elementIndex;i++){if(e.tagName=='LI')e.firstChild.setAttribute('open',1);e=e.parentElement;}this.setAttribute('selected','')this.scrollIntoViewIfNeeded(false);},response:response={onload:function(body){with(responsepanel.appendTag('div',{className:'col'})){appendTag('div',{innerText:'Response'});appendTag('pre',{className:'aco oa'}).appendTag('code',{innerText:this.getAllResponseHeaders()+(this.responseText[0]=="{"?JSON.stringify(JSON.parse(this.responseText),null,2):this.responseText)});appendTag('div').appendTag('button',{innerText:'Close',onclick:function(event){responsepanel.innerText='';}});}}},keys:{Escape:function(event){responsepanel.innerText='';}},events:{keydown:function(event){if(Doc.keys[event.key])Doc.keys[event.key](event);},scroll:function(event){Doc.navPath=Doc.navPath||document.body.appendTag('nav',{className:'path'});Doc.navPath.innerText='';var a=[],currentlevel=0,currentElement=null;for(var i=0,e,c=document.getElementById('content').getElementsByTagName('A');e=c[i];i++)if(e.indexElement){var rect=e.getBoundingClientRect();if(rect.top<100)currentElement=e;if(rect.top>70)break;var level=e.parentElement.tagName[1];currentlevel=level;a[level]=e.parentElement;}if(currentElement)Doc.selectIndexElement.call(currentElement.indexElement);for(var i=1;i<=currentlevel;i++){Doc.navPath.appendTag('a',{innerText:a[i].innerText});if(i<=currentlevel-1)Doc.navPath.appendText('-');}document.cookie="scrollY="+window.scrollY;},},buildobj:function(obj,level,path){if(!obj)return;var objectClass=obj.objectClass||Manual.getObjectClass(obj.obj);if(objectClass=='HTMLDivElement')return;if(['aliconnect','window','stylesheet'].indexOf(obj.name)!=-1)return console.log('skip',obj.name);if(allobjects.indexOf(obj.obj)!=-1)return console.log('REEDS GEDAAN by INDEX',obj.name);allobjects.push(obj.obj);with(document.getElementById('content')){appendTag('a',{name:obj.name});appendTag('h'+level,{innerText:obj.name}).appendTag('small',{innerText:":"+objectClass});with(appendTag('div',{className:'row reverse'})){appendTag('a',{innerText:obj.name});for(var parent=obj.parent;parent.name;parent=parent.parent)appendTag('a',{innerText:parent.name,href:'#'+parent.name});}if(obj.name in window&&window[obj.name]==obj.obj)obj.parent=topParent;if(typeof obj.obj=='function'){var s=String(obj.obj).replace(/\r\n\t/g, "\r\n").replace(/\t/g, ' ');var a=s.split(/\/[\*]|[\*]\if(a.length>1){appendTag('p',{innerHTML:a.splice(1,1).shift().trim().replace(/\r\n/g, "<br>")});s=a.join('');}s=s.split(/\r\n/g).filter(function(el){var el=el.trim();return el==''||el.substr(0,2)=='//'||el.substr(0,11)=='console.log'?false:true;}).join("\r\n");appendTag('code',{innerText:s})}var objchildren=[],chapters={Attribute:{title:'Attributes',items:[]},Object:{title:'Objects',items:[]},Function:{title:'Functions',items:[]},};for(var name in obj.obj)if(listobj=obj.obj[name]){var type=Manual.getObjectClass(listobj);objchildren.push({name:name,obj:listobj,parent:obj,type:type,chapter:['String','Date','Number','Array'].indexOf(type)!=-1?'Attribute':'Object'});}objchildren.sort(function(a,b){return a.name>b.name?1:b.name>a.name?-1:0;return a.name.localeCompare(b.name,"en",{caseFirst:'upper'});});objchildren.forEach(function(listobj){chapters[listobj.chapter].items.push(listobj);});for(var name in chapters){chapter=chapters[name];if(chapter.items.length){if(chapter.title=='Attributes'){with(appendTag('table')){chapter.items.forEach(function(obj){with(appendTag('tr')){appendTag('td',{className:'code',innerText:obj.name});appendTag('td',{className:'code',innerText:obj.type});appendTag('td',{className:'code',innerText:JSON.stringify(obj.obj,null,2)});}})}continue;}chapter.items.forEach(function(listobj){if(level<=3)Doc.buildobj(listobj,level+1,path+(path?'.':'')+obj.name);});}}}},getLib:function(fname){var fname=Doc.getLibList.shift();if(!fname)return Doc.createIndex();var ifrm=document.body.appendTag('iframe',{style:'display:none;'});ifrmw=(ifrm.contentWindow)?ifrm.contentWindow:(ifrm.contentDocument.document)?ifrm.contentDocument.document:ifrm.contentDocument;ifrmw.fname=fname;ifrmw.document.open();ifrmw.document.write('<script>Aim={add:function(obj){Aim=obj;},beforeLoad:function(){},config:{}};</script><script src="/aim/v1/lib/js/'+fname+'"></script>');ifrmw.addEventListener('load',function(){allobjects=[];Doc.buildobj({name:'Aim',objectClass:fname,obj:this.Aim,parent:topParent={}},1,'');this.frameElement.parentElement.removeChild(this.frameElement);Doc.getLib();},true)ifrmw.document.close();return;},showLib:function(){with(document.getElementById('content')){innerText='';Doc.getLibList=['main.js','app.js','om.js','site.js','mobile.js','aliconnector.js','upload.js','word.js','calendar.js','ganth.js','go.js','charts.js','three.js','doc.js','auth.js'];Doc.getLib();}},showDefinition:function(){with(document.getElementById('content')){innerText='';Object.forEachSorted(Aim.api.definitions,function(obj,schemaName){if(!obj.properties)return;appendTag('h1',{innerText:schemaName});appendTag('h2',{innerText:'Properties'});with(appendTag('ol')){Object.forEach(obj.properties,function(attribute,attributeName,i){with(appendTag('li')){appendTag('a',{innerText:attributeName,href:'#'+[schemaName,attributeName].join('_')});appendTag('span',{innerText:":"+(attribute.type=attribute.type||"text")});if(attribute.placeholder&&attribute.placeholder !=attributeName)appendTag('span',{innerText:'("'+attribute.placeholder+'")'});}});}Object.forEachSorted(obj.properties,function(attribute,attributeName,index,i){appendTag('h3',{innerText:attributeName,name:[schemaName,attributeName].join('_')});with(appendTag('table',{className:'code'})){var attributeProperties=[];Object.forEachSorted(attribute,function(property,propertyName){with(appendTag('tr')){appendTag('td',{className:'label',innerText:propertyName});appendTag('td',{innerText:JSON.stringify(property,function(key,value){return typeof value==='function'?undefined:value;},2)});}});}});});Doc.createIndex();}},showItemTree:function(itemId){console.log('showItemTree',Aim.api.item[itemId]);if(Aim.api.item[itemId]&&Aim.api.item[itemId].children&&Aim.api.item[itemId].children.length){console.log(this.data);Aim.api.item[itemId].children.forEach(Doc.createChapters.bind({level:1}));Doc.createIndex();return;}Aim.load({get:{schema:'item',id:itemId,child:5,select:'title,subject,summary,BodyHTML'},onload:function(event){Aim.api.item[this.get.id].children.forEach(Doc.createChapters.bind({level:1}));Doc.createIndex();}})},showSite:function(){document.getElementById('content').innerText='';Aim.load({get:{folder:"WebSite"},onload:function(){itemWebsite=this.data.value.shift();console.log(itemWebsite);Doc.showItemTree(itemWebsite.id);}});},showShop:function(){document.getElementById('content').innerText='';Aim.load({get:{folder:Aim.hostID,top:1,child:1,top:1,filter:"class eq 'System'"},onload:function(){console.log(this.src,this.data.value);itemTopSystem=this.data.value.shift();Aim.load({get:{folder:itemTopSystem.id,top:1,child:1,top:1,filter:"class eq 'System' and srcID eq masterID"},onload:function(){document.getElementById('content').innerText='';console.log(this.src,this.data.value);itemTopProduct=this.data.value.shift();Doc.showItemTree(itemTopProduct.id);}});}});},showTutorial:function(){},showHelp:function(){with(document.getElementById('content')){innerText='';appendTag('h1',{innerText:'Client'});with(appendTag('table')){for(var name in Aim.client){with(appendTag('tr')){appendTag('td',{innerText:name});if(Aim.client[name]){appendTag('td',{innerText:Aim.client[name].name||''});appendTag('td',{innerText:Aim.client[name].id||''});appendTag('td',{innerText:Aim.client[name].uid||''});}}}}appendTag('div').appendTag('a',{innerText:'Auth',href:auth.getLoginUrl()});}Doc.showItemTree(3557403);},showAPI:function(){with(document.getElementById('content')){innerText='';content.forEach(Doc.createChapters.bind({level:1}));Doc.createIndex();}},showJS:function(){document.getElementById('content').innerText='';setTimeout(function(){with(document.getElementById('content')){allobjects=[];Aim.Manual.buildobj({name:'Aim',obj:Aim,parent:topParent={}},1,'');Doc.createIndex();}},0);},on:{load:function(){}}});